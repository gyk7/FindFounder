<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>게시글 상세보기</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-5">
    <div class="card">
        <div class="card-body">
            <h2 id="postTitle">게시글 제목</h2>
            <p class="text-muted">작성자: <span id="writer">작성자 이름</span></p>
            <p class="text-muted">작성일: <span id="postDate"></span></p>
            <p id="postContent">게시글 내용이 여기에 들어갑니다.</p>
            <p><strong>조회수:</strong> <span id="postViews">0</span></p>
            <p><strong>게시글번호:</strong> <span id="postId">0</span></p>
            <button id="postLike" class="btn btn-success">좋아요 <span id="likeCount">0</span></button>
            <button id="postDislike" class="btn btn-danger">싫어요 <span id="dislikeCount">0</span></button>
        </div>
    </div>

    <div class="card mt-4">
        <div class="card-body">
            <h4>댓글</h4>
            <ul id="commentsList" class="list-unstyled">
                <!-- 댓글 내용이 여기에 추가됩니다 -->
            </ul>
            <textarea id="commentInput" class="form-control mt-3" placeholder="댓글을 입력하세요..."></textarea>
            <button class="btn btn-primary mt-2" onclick="addComment()">댓글 작성</button>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="js/scripts.js"></script>
<script>
var url = 'http://localhost:8080/api/board/detail' + window.location.search;
var commentUrl  = 'http://localhost:8080/api/comment'+ window.location.search;
$(document).ready(
		
	    function() {
	            $.ajax(
          		{
	                type: 'GET',
	                url: url, // 로그인 엔드포인트 URL
	                contentType: 'application/json',
	                
	                success: function(response) {
	                	console.log(response)
	                	
	                	document.getElementById('postTitle').textContent = response.postTitle;
	                	document.getElementById('writer').textContent = response.writer;
	                	document.getElementById('postContent').textContent = response.postContent;
	                	document.getElementById('postViews').textContent = response.postViews;
	                	document.getElementById('postDate').textContent = response.postDate;
	                	document.getElementById('postId').textContent = response.postId;
	                	document.getElementById('likeCount').textContent = response.postLike;
	                	document.getElementById('dislikeCount').textContent = response.postDislike;
	                }
	            },
          		
          		{
	                type: 'GET',
	                url: commentUrl, // 로그인 엔드포인트 URL
	                contentType: 'application/json',
	                
	                success: function(response) {
	                	console.log(response)
	                	
	                	document.getElementById('postTitle').textContent = response.postTitle;
	                	document.getElementById('writer').textContent = response.writer;
	                	document.getElementById('postContent').textContent = response.postContent;
	                	document.getElementById('postViews').textContent = response.postViews;
	                	document.getElementById('postDate').textContent = response.postDate;
	                	document.getElementById('postId').textContent = response.postId;
	                	document.getElementById('likeCount').textContent = response.postLike;
	                	document.getElementById('dislikeCount').textContent = response.postDislike;
	                }
	            }
	            
	            )
	    
	    }
	    );

</script>

<script>
function addComment() {
    var commentInput = document.getElementById('commentInput').value; // 입력된 댓글 내용 가져오기
    var postId = document.getElementById('postId').textContent;
    if (commentInput.trim() === '') {
        alert('댓글을 입력해주세요.');
        return;
    }
	console.log(document.getElementById('postId').textContent);
    var data = JSON.stringify({
        commentContent: commentInput,
        postId: postId // 게시글 ID, 페이지나 API로부터 가져와야 함
    });

    $.ajax({
        type: 'POST',
        url: '/api/comment', // 댓글 작성 API
        contentType: 'application/json',
        data: data,
        success: function(response) {
            // 댓글 목록에 새 댓글 추가
            var commentsList = document.getElementById('commentsList');
            var newComment = document.createElement('li');
            newComment.textContent = commentInput; // 댓글 내용 설정
            commentsList.appendChild(newComment);

            // 댓글 입력 필드 초기화
            document.getElementById('commentInput').value = '';
            alert('댓글이 성공적으로 작성되었습니다.');
        },
        error: function(xhr, status, error) {
            console.error('댓글 작성 실패:', error);
            alert('댓글 작성에 실패했습니다.');
        }
    });
}
</script>
</body>

</html>